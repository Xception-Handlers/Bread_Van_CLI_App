<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>{% block title %}Bread Van App{% endblock %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Materialize CSS (or Bootstrap if you prefer) -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css"
      rel="stylesheet"
    />
    <!-- Google Material Icons -->
    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet"
    />

    <style>
      body {
        background: #f7f7f7;
      }
      nav {
        margin-bottom: 20px;
      }
      .brand-logo {
        font-weight: 600;
      }
      main {
        min-height: 70vh;
      }
      footer {
        padding: 10px 0;
      }

      #flash-container {
        position: fixed;
        top: 16px;
        left: 50%;
        transform: translateX(-50%);
        z-index: 9999;
        pointer-events: none; /* clicks pass through unless on the toast */
      }

      /* Individual toast */
      .flash-message {
        background: #323232;
        color: white;
        padding: 14px 18px;
        border-radius: 12px;
        margin: 6px 0;
        max-width: 420px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);
        opacity: 0;
        transform: translateY(-20px);
        transition: all 0.45s ease;
        pointer-events: auto; /* can still select/copy text in toast */
      }

      .flash-show {
        opacity: 1;
        transform: translateY(0);
      }

      .flash-hide {
        opacity: 0;
        transform: translateY(-20px);
      }

      /* Optional: colour hints for different categories */
      .flash-message.success {
        background: #2e7d32;
      }
      .flash-message.error {
        background: #c62828;
      }
      .flash-message.info {
        background: #1565c0;
      }

      body {
        background: linear-gradient(135deg, #fff3e0, #ffe0b2);
        font-family: "Roboto", sans-serif;
      }

      nav {
        margin-bottom: 20px;
      }

      .brand-logo {
        font-weight: 600;
      }

      main {
        min-height: 70vh;
      }

      footer {
        padding: 10px 0;
      }

      /* Shared rounded card look */
      .bv-card {
        border-radius: 18px;
        overflow: hidden;
        background: #ffffff;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.08);
      }

      .bv-card-header {
        padding-bottom: 10px;
        margin-bottom: 10px;
        border-bottom: 1px solid #f0f0f0;
      }

      .bv-section-title {
        font-weight: 600;
        margin-bottom: 16px;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .bv-section-title i {
        font-size: 1.4rem;
      }

      /* Rounded bakery-style button */
      .rounded-btn {
        border-radius: 30px !important;
        padding: 0 18px !important;
        height: 40px !important;
        line-height: 40px !important;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        font-size: 15px;
        font-weight: 600;
        text-transform: none;
        background-color: #6d4c41 !important; /* warm bakery brown */
      }

      .rounded-btn:hover {
        background-color: #8d6e63 !important;
      }

      /* Small pill labels (e.g. status, roles) */
      .pill-badge {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        border-radius: 999px;
        padding: 2px 10px;
        font-size: 12px;
        font-weight: 500;
        background-color: #ffe0b2;
        color: #5d4037;
      }
    </style>

    {% block head %}{% endblock %}
  </head>
  <body>
    <nav>
      <div class="nav-wrapper teal">
        <a
          href="{{ url_for('index_views.index_page') }}"
          class="brand-logo"
          style="padding-left: 15px"
        >
          Bread Van
        </a>
        <ul id="nav-mobile" class="right hide-on-med-and-down">
          {% if is_authenticated %} {% if current_user.type == 'Admin' %}
          <li>
            <a href="{{ url_for('web_views.admin_dashboard') }}"
              >Admin Dashboard</a
            >
          </li>
          {% elif current_user.type == 'Driver' %}
          <li>
            <a href="{{ url_for('web_views.driver_dashboard') }}"
              >Driver Dashboard</a
            >
          </li>
          {% elif current_user.type == 'Resident' %}
          <li>
            <a href="{{ url_for('web_views.resident_dashboard') }}"
              >Resident Dashboard</a
            >
          </li>
          {% endif %}
          <li>
            <a href="{{ url_for('web_views.logout') }}"
              >Logout ({{ current_user.username }})</a
            >
          </li>
          {% else %}
          <li><a href="{{ url_for('web_views.login') }}">Login</a></li>
          {% endif %}
        </ul>
      </div>
    </nav>

    <main class="container">
      <div id="flash-container">
        {% with msgs = get_flashed_messages(with_categories=true) %} {% if msgs
        %} {% for category, msg in msgs %}
        <div class="flash-message {{ category }}">{{ msg }}</div>
        {% endfor %} {% endif %} {% endwith %}
      </div>

      {% block content %}{% endblock %}
    </main>

    <footer class="grey lighten-3">
      <div class="container">
        <span class="grey-text">Bread Van App &copy; {{ 2025 }}</span>
      </div>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    {% block scripts %}
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        var elems = document.querySelectorAll("select");
        M.FormSelect.init(elems);
      });
    </script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const flashes = document.querySelectorAll(".flash-message");

        flashes.forEach((el, index) => {
          // Staggered small delay so they animate nicely
          setTimeout(() => {
            el.classList.add("flash-show");
          }, 50 + index * 80);

          // Auto-hide after 3s + stagger
          const delay = 3000 + index * 500;

          setTimeout(() => {
            el.classList.add("flash-hide");

            el.addEventListener("transitionend", () => {
              if (el && el.parentNode) {
                el.parentNode.removeChild(el);
              }
            });
          }, delay);
        });
      });
    </script>
    {% endblock %}
  </body>
</html>
